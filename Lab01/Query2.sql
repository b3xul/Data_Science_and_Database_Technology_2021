SELECT MESE, SUM(CHIAMATE) AS CHIAMATE_TOTALI, SUM(PREZZO) AS INCASSO_TOTALE, RANK() OVER (ORDER BY SUM(PREZZO) DESC)
FROM TEMPO T, FATTI F
WHERE T.ID_TEMPO=F.ID_TEMPO
GROUP BY MESE;